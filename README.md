# ЁЯУШ PostgreSQL Questions

## рзз. PostgreSQL ржХрзА?

**PostgreSQL** ржПржХржЯрж┐ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА, ржУржкрзЗржи-рж╕рзЛрж░рзНрж╕ **рж░рж┐рж▓рзЗрж╢ржирж╛рж▓ ржбрж╛ржЯрж╛ржмрзЗрж╕ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ рж╕рж┐рж╕рзНржЯрзЗржо (RDBMS)**ред ржПржЯрж┐ ANSI SQL ржорж╛ржи ржорзЗржирзЗ ржЪрж▓рзЗ ржПржмржВ ржбрзЗржЯрж╛ рж╕ржарж┐ржХржнрж╛ржмрзЗ рж╕ржВрж░ржХрзНрж╖ржг ржУ ржкрж░рж┐ржЪрж╛рж▓ржирж╛рж░ ржЬржирзНржп **ACID** ржирзАрждрж┐ржорж╛рж▓рж╛ ржЕржирзБрж╕рж░ржг ржХрж░рзЗред

#### PostgreSQL ржжрж┐рзЯрзЗ ржЖржорж░рж╛ ржХрзА ржХрзА ржХрж░рждрзЗ ржкрж╛рж░рж┐:

- ржбрзЗржЯрж╛ рж╕ржВрж░ржХрзНрж╖ржг, рж╣рж╛рж▓ржирж╛ржЧрж╛ржж, ржорзБржЫрзЗ ржлрзЗрж▓рж╛ ржУ ржЕржирзБрж╕ржирзНржзрж╛ржи ржХрж░рж╛ред
- `JOIN`, `GROUP BY`, `JSON`, `CTE`, `Window Functions` ржЗрждрзНржпрж╛ржжрж┐ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржлрж┐ржЪрж╛рж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐ред
- GIS ржмрж╛ Location Data ржкрж░рж┐ржЪрж╛рж▓ржирж╛рж░ ржЬржирзНржп PostGIS ржПрж░ ржоржд ржПржХрзНрж╕ржЯрзЗржирж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐ред

####  PostgreSQL ржПрж░ ржХрж┐ржЫрзБ рж╕рж╛ржзрж╛рж░ржг ржмрзНржпржмрж╣рж╛рж░:

- ржУрзЯрзЗржм ржУ ржорзЛржмрж╛ржЗрж▓ ржПржкрзНрж▓рж┐ржХрзЗрж╢ржи рждрзИрж░рж┐,
- ржлрж┐ржирзНржпрж╛ржирзНрж╕, рж╕рзНржмрж╛рж╕рзНржерзНржп ржУ рж░рж┐рж╕рж╛рж░рзНржЪ ржбрзЗржЯрж╛ржмрзЗрж╕ рждрзИрж░рж┐рждрзЗ

---

## рзи. PostgreSQL-ржП ржбрж╛ржЯрж╛ржмрзЗрж╕ рж╕рзНржХрж┐ржорж╛рж░ ржЙржжрзНржжрзЗрж╢рзНржп ржХрзА?

**рж╕рзНржХрж┐ржорж╛ (Schema)** рж╣рж▓рзЛ ржПржХржЯрж┐ ржбрзЗржЯрж╛ржмрзЗрж╕рзЗрж░ ржнрж┐рждрж░рзЗ ржЖрж▓рж╛ржжрж╛ ржлрзЛрж▓рзНржбрж╛рж░ ржпрж╛ ржЯрзЗржмрж┐рж▓, ржнрж┐ржЙ, ржлрж╛ржВрж╢ржи ржЗрждрзНржпрж╛ржжрж┐ржХрзЗ ржЧрзБржЫрж┐рзЯрзЗ рж░рж╛ржЦрзЗред ржПржЯрж┐ ржбрзЗржЯрж╛ржмрзЗрж╕рзЗ ржмрж┐ржнрж┐ржирзНржи ржЕржВрж╢ рждрзИрж░рж┐ ржХрж░рзЗ ржпрж╛рждрзЗ ржПржХрж╛ржзрж┐ржХ ржЗржЙржЬрж╛рж░ ржмрж╛ ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржи ржПржХржЗ ржбрзЗржЯрж╛ржмрзЗрж╕рзЗ ржХрж╛ржЬ ржХрж░рждрзЗ ржкрж╛рж░рзЗ ржХрзЛржирзЛ рж╕ржорж╕рзНржпрж╛ ржЫрж╛рзЬрж╛ред

####  ржпрзЗржоржи:

```sql
CREATE SCHEMA school;
CREATE TABLE school.students (...);
CREATE TABLE school.teachers (...);
```

ржПржЦрж╛ржирзЗ `school` рж╕рзНржХрж┐ржорж╛рж░ ржЕржзрзАржирзЗ `students` ржПржмржВ `teachers` ржЯрзЗржмрж┐рж▓ ржжрзБржЗржЯрж┐ ржЖрж▓рж╛ржжрж╛ржнрж╛ржмрзЗ рж╕ржВрж░ржХрзНрж╖рж┐рждред

---

## рзй. Primary Key ржПржмржВ Foreign Key ржХрзА?

**Primary Key**:

- ржПржХржЯрж┐ ржЯрзЗржмрж┐рж▓рзЗрж░ ржЗржЙржирж┐ржХ ржЖржЗржбрзЗржирзНржЯрж┐ржлрж╛рзЯрж╛рж░ред
- NULL ржУ ржбрзБржкрзНрж▓рж┐ржХрзЗржЯ ржнрзНржпрж╛рж▓рзБ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ ржирж╛ред

```sql
CREATE TABLE students (
    student_id SERIAL PRIMARY KEY,
    name VARCHAR(50)
);
```

**Foreign Key**:

- ржПржХржЯрж┐ ржЯрзЗржмрж┐рж▓рзЗ ржПржоржи ржПржХржЯрж┐ ржХрж▓рж╛ржо ржпрж╛ ржЕржирзНржп ржЯрзЗржмрж┐рж▓рзЗрж░ `PRIMARY KEY` ржПрж░ рж╕рж╛ржерзЗ рж╕ржВржпрзБржХрзНржд ржерж╛ржХрзЗред
- ржПржЯрж┐ рж░рзЗржлрж╛рж░рзЗржирзНрж╕ ржмрж╛ рж╕ржорзНржкрж░рзНржХ рждрзИрж░рж┐ ржХрж░рзЗред

```sql
CREATE TABLE courses (
    course_id SERIAL PRIMARY KEY,
    student_id INT REFERENCES students(student_id)
);
```

ржПржЦрж╛ржирзЗ `courses.student_id` рж╣рж▓рзЛ `students.student_id` ржПрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржирж┐рж░рзНржнрж░рж╢рзАрж▓ред

---

### рзк. SELECT рж╕рзНржЯрзЗржЯржорзЗржирзНржЯрзЗ WHERE ржХрзНрж▓ржЬрзЗрж░ ржЙржжрзНржжрзЗрж╢рзНржп ржХрзА?

`WHERE` ржХрзНрж▓ржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╢рж░рзНржд ржЕржирзБржпрж╛рзЯрзА ржбрзЗржЯрж╛ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рж╛ ржпрж╛рзЯред

#### ржЙржжрж╛рж╣рж░ржг:

```sql
SELECT * FROM employees WHERE department = 'HR';
```

ржПржЦрж╛ржирзЗ рж╢рзБржзрзБ HR ржбрж┐ржкрж╛рж░рзНржЯржорзЗржирзНржЯрзЗрж░ ржПржоржкрзНрж▓рзЯрж┐ржжрзЗрж░ рж░рзЗржХрж░рзНржб ржжрзЗржЦрж╛ржирзЛ рж╣ржмрзЗред

`WHERE` ржЫрж╛рзЬрж╛ `SELECT` ржХрж░рж▓рзЗ рж╕ржм рж░рзЗржХрж░рзНржб ржжрзЗржЦрж╛рзЯ, ржХрж┐ржирзНрждрзБ рж╢рж░рзНрждржпрзБржХрзНржд ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ ржПрж░ ржЬржирзНржп `WHERE` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣ржмрзЗред

---

### рзл. LIMIT ржПржмржВ OFFSET ржХрзНрж▓ржЬ ржХрзА ржХрж╛ржЬрзЗ рж▓рж╛ржЧрзЗ?

- `LIMIT`: ржХрзЯржЯрж┐ рж░рзЗржХрж░рзНржб ржжрзЗржЦрж╛ржмрзЗ рждрж╛ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗред
- `OFFSET`: ржХрзЯржЯрж┐ рж░рзЗржХрж░рзНржб рж╕рзНржХрж┐ржк ржХрж░ржмрзЗ рждрж╛ ржмрж▓рзЗ ржжрзЗрзЯред

####  ржЙржжрж╛рж╣рж░ржг:

```sql
SELECT * FROM students LIMIT 5 OFFSET 10;
```

ржПржЗ ржХрзБрзЯрзЗрж░рж┐ржЯрж┐ рззрзз ржерзЗржХрзЗ рззрзл ржиржорзНржмрж░ рж╢рж┐ржХрзНрж╖рж╛рж░рзНржерзАрж░ рждржерзНржп ржжрзЗржЦрж╛ржмрзЗред

Limit ржПржмржВ Offset Pagination ржмрж╛ Page-by-page рж░рзЗржЬрж╛рж▓рзНржЯ ржжрзЗржЦрж╛ржирзЛрж░ ржЬржирзНржп ржЦрзБржмржЗ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржгред

---

### рзм. PostgreSQL-ржП JOIN ржЕржкрж╛рж░рзЗрж╢ржирзЗрж░ ржЧрзБрж░рзБрждрзНржм ржХрзА ржПржмржВ ржПржЯрж┐ ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

**JOIN** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржХрж╛ржзрж┐ржХ ржЯрзЗржмрж┐рж▓ ржерзЗржХрзЗ рж╕ржорзНржкрж░рзНржХрж┐ржд ржбрзЗржЯрж╛ ржирж┐рзЯрзЗ ржХрж╛ржЬ ржХрж░рж╛ ржпрж╛рзЯред ржПржЯрж┐ **рж░рж┐рж▓рзЗрж╢ржирж╛рж▓ ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗрж░** ржЕржирзНржпрждржо рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржлрж┐ржЪрж╛рж░ред

#### ржЙржжрж╛рж╣рж░ржг:

```sql
SELECT students.name, departments.name
FROM students
JOIN departments ON students.department_id = departments.id;
```

ржПржЦрж╛ржирзЗ `students` ржПржмржВ `departments` ржЯрзЗржмрж┐рж▓ржХрзЗ `department_id` ржПрж░ ржорж╛ржзрзНржпржорзЗ ржпрзБржХрзНржд ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред

**JOIN-ржПрж░ ржкрзНрж░ржХрж╛рж░ржнрзЗржж:**

- `INNER JOIN`: рж╢рзБржзрзБржорж╛рждрзНрж░ ржорж┐рж▓рзЗ ржпрж╛ржУрзЯрж╛ рж░рзЗржХрж░рзНржб
- `LEFT JOIN`: ржмрж╛ржо ржЯрзЗржмрж┐рж▓рзЗрж░ рж╕ржм рж░рзЗржХрж░рзНржб, ржбрж╛ржи ржжрж┐ржХрзЗ ржирж╛ ржорж┐рж▓рж▓рзЗ `NULL`
- `RIGHT JOIN`: ржбрж╛ржи ржЯрзЗржмрж┐рж▓рзЗрж░ рж╕ржм рж░рзЗржХрж░рзНржб, ржмрж╛ржорзЗ ржирж╛ ржорж┐рж▓рж▓рзЗ `NULL`
- `FULL JOIN`: ржЙржнрзЯ ржЯрзЗржмрж┐рж▓рзЗрж░ рж╕ржм рж░рзЗржХрж░рзНржб, ржирж╛ ржорж┐рж▓рж▓рзЗ `NULL`

ржЪрж▓рзЛ ржЖржорж░рж╛ ржПржХржЯрж┐ **ржЦрзБржмржЗ рж╕рж╣ржЬ ржПржмржВ ржкрзНрж░рж╛рж╕ржЩрзНржЧрж┐ржХ ржЙржжрж╛рж╣рж░ржг** ржжрзЗржЦрж┐ тАФ ржпрзЗржЦрж╛ржирзЗ ржерж╛ржХржмрзЗ **Students** ржПржмржВ **Clubs** ржЯрзЗржмрж┐рж▓ред

---

ржЯрзЗржмрж┐рж▓ рзз: `students`

| student_id | name    |
| ---------- | ------- |
| 1          | Alice   |
| 2          | Bob     |
| 3          | Charlie |

---

ржЯрзЗржмрж┐рж▓ рзи: `clubs`

| student_id | club_name  |
| ---------- | ---------- |
| 2          | Chess Club |
| 3          | Drama Club |
| 4          | Math Club  |

---

ржПржЦржи ржЖржорж░рж╛ `student_id` ржПрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ `LEFT JOIN` ржПржмржВ `RIGHT JOIN` ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмред

- **LEFT JOIN: "рж╕ржм student ржжрзЗржЦрж╛ржУ, ржПржоржиржХрж┐ ржпрж╛рж░рж╛ ржХрзЛржирзЛ ржХрзНрж▓рж╛ржмрзЗ ржирзЗржЗ"**

```sql
SELECT students.name, clubs.club_name
FROM students
LEFT JOIN clubs ON students.student_id = clubs.student_id;
```

### ржлрж▓рж╛ржлрж▓:

| name    | club_name  |                          |
| ------- | ---------- | ------------------------ |
| Alice   | NULL       | тЭМ Alice ржХрзЛржирзЛ ржХрзНрж▓рж╛ржмрзЗ ржирзЗржЗ |
| Bob     | Chess Club | тЬЕ Bob ржХрзНрж▓рж╛ржмрзЗ ржЖржЫрзЗ        |
| Charlie | Drama Club | тЬЕ Charlie ржХрзНрж▓рж╛ржмрзЗ ржЖржЫрзЗ    |

тЬЕ **рж╕ржм student ржжрзЗржЦрж╛ржпрж╝**, ржПржоржиржХрж┐ ржпржжрж┐ рждрж╛ржжрзЗрж░ ржХрзНрж▓рж╛ржмрзЗ ржирж╛-ржУ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ред

---

- **RIGHT JOIN: "рж╕ржм ржХрзНрж▓рж╛ржм ржжрзЗржЦрж╛ржУ, ржПржоржиржХрж┐ рж╕рзЗржЗ рж╕ржм ржХрзНрж▓рж╛ржмржУ ржпрж╛ржжрзЗрж░ student ржирзЗржЗ"**

```sql
SELECT students.name, clubs.club_name
FROM students
RIGHT JOIN clubs ON students.student_id = clubs.student_id;
```

### ржлрж▓рж╛ржлрж▓:

| name    | club_name  |                              |
| ------- | ---------- | ---------------------------- |
| Bob     | Chess Club | тЬЕ ржорж┐рж▓рзЗ ржЧрзЗржЫрзЗ                 |
| Charlie | Drama Club | тЬЕ ржорж┐рж▓рзЗ ржЧрзЗржЫрзЗ                 |
| NULL    | Math Club  | тЭМ student_id 4 рждрж╛рж▓рж┐ржХрж╛ржпрж╝ ржирзЗржЗ |

тЬЕ **рж╕ржм ржХрзНрж▓рж╛ржм ржжрзЗржЦрж╛ржпрж╝**, ржПржоржиржХрж┐ student рждрж╛рж▓рж┐ржХрж╛ржпрж╝ ржирж╛ ржерж╛ржХрж▓рзЗржУред

---

#### рж╕рж╛рж░рж╛ржВрж╢:

| JOIN ржЯрж╛ржЗржк  | рж╕ржмрж╕ржоржпрж╝ ржХрзЛржи ржЯрзЗржмрж┐рж▓ рж░рж╛ржЦрзЗ  | ржорж┐рж▓ ржирж╛ ржкрзЗрж▓рзЗ ржХрзЛржерж╛ржпрж╝ NULL рж╣ржпрж╝ |
| ---------- | ---------------------- | --------------------------- |
| LEFT JOIN  | ржмрж╛ржо ржЯрзЗржмрж┐рж▓ (`students`) | ржбрж╛ржи ржЯрзЗржмрж┐рж▓ (`clubs`)         |
| RIGHT JOIN | ржбрж╛ржи ржЯрзЗржмрж┐рж▓ (`clubs`)    | ржмрж╛ржо ржЯрзЗржмрж┐рж▓ (`students`)      |

---

> A LEFT JOIN B ржЖрж░ B RIGHT JOIN A ржПржХржЗред

### рзн. GROUP BY ржХрзНрж▓ржЬ ржХрзА ржПржмржВ ржПржЯрж┐ Aggregation-ржПрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржХрзАржнрж╛ржмрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯ?

`GROUP BY` ржХрзНрж▓ржЬ ржжрж┐рзЯрзЗ ржЖржорж░рж╛ ржбрзЗржЯрж╛ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЧрзНрж░рзБржкрзЗ ржнрж╛ржЧ ржХрж░рждрзЗ ржкрж╛рж░рж┐ ржПржмржВ ржкрзНрж░рждрж┐ржЯрж┐ ржЧрзНрж░рзБржкрзЗ ржЖрж▓рж╛ржжрж╛ ржХрж░рзЗ Aggregation ржХрж░рждрзЗ ржкрж╛рж░рж┐ред

#### ржЙржжрж╛рж╣рж░ржг:

```sql
SELECT department, COUNT(*) AS total_employees
FROM employees
GROUP BY department;
```

ржПржЦрж╛ржирзЗ ржкрзНрж░рждрж┐ржЯрж┐ ржбрж┐ржкрж╛рж░рзНржЯржорзЗржирзНржЯрзЗ ржХрждржЬржи ржХрж░рзНржорзА ржЖржЫрзЗржи рждрж╛ ржЧржгржирж╛ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред

---

### рзо. PostgreSQL-ржП COUNT(), SUM(), AVG() ржлрж╛ржВрж╢ржи ржХрж┐ржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

ржПржЗ ржлрж╛ржВрж╢ржиржЧрзБрж▓рзЛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржбрзЗржЯрж╛рж░ ржЙржкрж░ ржЧржгржирж╛ржорзВрж▓ржХ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рж╛ ржпрж╛рзЯ:

| ржлрж╛ржВрж╢ржи     | ржХрж╛ржЬ              |
| --------- | ---------------- |
| `COUNT()` | ржХрждржЯрж┐ рж░рзЗржХрж░рзНржб ржЖржЫрзЗ  |
| `SUM()`   | ржорж╛ржиржЧрзБрж▓рзЛрж░ ржпрзЛржЧржлрж▓   |
| `AVG()`   | ржЧрзЬ ржорж╛ржи рж╣рж┐рж╕рж╛ржм ржХрж░рзЗ |

#### ржЙржжрж╛рж╣рж░ржг:

```sql
SELECT COUNT(*) FROM orders;
SELECT SUM(price) FROM products;
SELECT AVG(salary) FROM employees;
```

---
